"use strict";var colorlegend=function(t,e,n,r){var l=["linear","quantile","ordinal"],a=!1,i=r||{},o=i.boxWidth||20,s=i.boxHeight||20,d=i.title||null,g=i.fill||!1,f=i.linearBoxes||9,h=document.getElementById("#"===t.substring(0,1)?t.substring(1,t.length):t),c=h.offsetWidth,u=h.offsetHeight,p=[],x=[2,4,10,4],y="ordinal"===n?3:0,m=d?11:0,v=e.domain(),b=e.range(),w=0;for(w=0;w<l.length;w++)if(l[w]===n){a=!0;break}if(!a)throw new Error("Scale type, "+n+", is not suported.");if("quantile"===n)p=b;else if("ordinal"===n)for(w=0;w<v.length;w++)p[w]=b[w];else if("linear"===n){var q=v[0],B=v[v.length-1];for(w=0;f>w;w++)p[w]=e(q+w*((B-q)/f))}(g||c<(o+y)*p.length+x[1]+x[3])&&(o=(c-x[1]-x[3]-y*p.length)/p.length),(g||u<s+x[0]+x[2]+m)&&(s=u-x[0]-x[2]-m);var E=d3.select(t).append("svg").attr("width",c).attr("height",u).append("g").attr("class","colorlegend").attr("transform","translate("+x[3]+","+x[0]+")").style("font-size","11px").style("fill","#666"),H=E.selectAll("g.legend").data(p).enter().append("g");return H.append("text").attr("class","colorlegend-labels").attr("dy",".71em").attr("x",function(t,e){return e*(o+y)+("ordinal"!==n?o/2:0)}).attr("y",function(){return s+2}).style("text-anchor",function(){return"ordinal"===n?"start":"middle"}).style("pointer-events","none").text(function(t,e){return"ordinal"===n?v[e]:0===e?v[0]:e===p.length-1?d3.format(",")(v[v.length-1]):void 0}),H.append("rect").attr("x",function(t,e){return e*(o+y)}).attr("width",o).attr("height",s).style("fill",function(t,e){return p[e]}),d&&E.append("text").attr("class","colorlegend-title").attr("x",p.length*(o/2)).attr("y",s+m).attr("dy",".71em").style("text-anchor","middle").style("pointer-events","none").text(d),this};